<!--

To INCLUDE this file:

REQUIRED context:
	None

OPTIONAL context:
	expositions

-->

<!-- Should make this prettier -->
<div id="report"> </div>
<table id="expos" class="tablesorter">
    <thead>
        <th data-sorter="false"> </th>
        <th>Name</th>
        <th>Created By</th>
        <th>Votes</th>
        <th data-sorter="false">Options</th>
        <th style="display:none;">Is Stickied</th>
    </thead>
  <tbody>
    {% for e in stickied_expositions %}
      <tr id="row-1-{{ e.id }}">
          <td>
            {% include "rating/vote_arrows.html" with item=1 id=e.id %}
          </td>

        <td>
        	<a class="expo_link" data-toggle="modal" href="expo_modal" data-href="{{ e.link }}">
            <div class="name-1-{{ e.id }}">
              {{ e.title }} [stickied]
            </div>
          </a>
        </td>
        <td>
          {{ e.owner }}
        </td>
          <td>
              <div class="votes-sum-1-{{e.id}}">
                  {{e.votes}}
              </div>
          </td>
        <td>
        <!-- Button to trigger modal -->
          <a rel="tooltip" class="icon-flag" href="#myModalExpo{{e.id}}" data-toggle="modal" title="Report"></a>
          {% include "web/home/shared/sticky.html" with type=1 %}
          {% if user.is_superuser or e.owner == user %}
            <a rel="tooltip" class="icon-edit" href="{% url "expo_submit" e.id %}?next={{request.path}}" title="Edit"></a>
            <a rel="tooltip" class="icon-remove" href="#deleteModal1{{ e.id }}" data-toggle="modal" title="Delete"></a>
            {% comment %} We only need to include this modal if the user is allowed to delete {% endcomment %}
            {% include "web/home/shared/delete_modal.html" with type=1 name=e.title %}
          {% endif %}
        </td>
        <td style="display:none;"><div class="stickied-1-{{ e.id }}">1</div></td>
      </tr>
      <!-- Modal -->
      {% include "web/home/shared/report_modal.html" with type="Expo" %}
    {% endfor %}
    
    
    {% for e in expositions %}
      <tr id="row-1-{{ e.id }}">
          <td>
            {% include "rating/vote_arrows.html" with item=1 id=e.id %}
          </td>

        <td>
        	<a class="expo_link" data-toggle="modal" href="expo_modal" data-href="{{ e.link }}">
            <div class="name-1-{{ e.id }}">
              {{ e.title }}
            </div>
            
          </a>
        </td>
        <td>
          {{ e.owner }}
        </td>
          <td>
              <div class="votes-sum-1-{{e.id}}">
                  {{e.votes}}
              </div>
          </td>
          <td>
          <!-- Button to trigger modal -->
            <a rel="tooltip" class="icon-flag" href="#myModalExpo{{e.id}}" data-toggle="modal" title="Report"></a>
            {% include "web/home/shared/sticky.html" with type=1 %}
            {% if user.is_superuser or e.owner == user %}
              <a rel="tooltip" class="icon-edit" href="{% url "expo_submit" e.id %}?next={{request.path}}" title="Edit"></a>
              <a rel="tooltip" class="icon-remove" href="#deleteModal1{{ e.id }}" data-toggle="modal" title="Delete"></a>
              {% comment %} We only need to include this modal if the user is allowed to delete {% endcomment %}
              {% include "web/home/shared/delete_modal.html" with type=1 name=e.title %}
            {% endif %}
          </td>
        <td style="display:none;"><div class="stickied-1-{{ e.id }}">0</div></td>
      </tr>
      <!-- Modal -->
     {% include "web/home/shared/report_modal.html" with type="Expo" %}
    {% endfor %}
  </tbody>
</table>

<script>{% include 'js/tablesorter.settings.js' with table='#expos' sortForce='[[5,1]]' sortAppend='[[3,1]]' sortList='[[5,1],[3,1]]' %}</script>


<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}/css/knoatom.css" />
<script type="text/javascript">
    $('textarea').addClass('span6').wysihtml5();
    $('.expo_link').each(function() {
        $(this).click(function() {
            $($('#expo_modal').children()[1]).html('<iframe style="width:1024px;height:400px" src="'+$(this).attr('data-href')+'">Loading...</iframe>');
            $('#expo_modal').modal('toggle').css({
                width:'auto',
                'margin-left':function(){
                    return -($(this).width()/2);
                                                 }
            });
        })
    });
    
</script>


