{% extends "assignment_nav.html" %}
{% block content %}
{% load my_filters %}

<!-- TINY MCE -->
<script type="text/javascript" src="{{ STATIC_PREFIX }}tinymce/js/tinymce/tinymce.min.js"></script>

<!-- CODE MIRROR -->
<script src="{{ STATIC_PREFIX }}codemirror/lib/codemirror.js"></script>
<script src="{{ STATIC_PREFIX }}codemirror/mode/python/python.js"></script>
<link rel="stylesheet" href="{{ STATIC_PREFIX }}codemirror//lib/codemirror.css">
<link rel="stylesheet" href="{{ STATIC_PREFIX }}codemirror//lib/themes.css">

<!-- bootstrap js -->
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/bootstrap.js"></script>

<!-- font awesome -->
<link rel="stylesheet" type="test/css" href="{{ STATIC_PREFIX }}css/test.css">
<link rel="stylesheet" href="{{ STATIC_PREFIX }}font-awesome/css/font-awesome.min.css">

<!-- JQUERY UI -->
<link rel="stylesheet" href="{{ STATIC_PREFIX }}jquery-ui/css/ui-lightness/jquery-ui-1.10.3.custom.min.css">

<!-- nyromodal -->
<link rel="stylesheet" href="{{STATIC_PREFIX}}nyromodal/styles/nyroModal.css" type="text/css" media="screen" />
<script type="text/javascript" src="{{STATIC_PREFIX}}nyromodal/js/jquery.nyroModal.custom.js"></script>

<!-- javascript -->
<script type="text/javascript" src="{{ STATIC_PREFIX }}js/assignment.js"></script>

<html>

<body>
	<button class="btn btn-success" id="loadA">Load Assignment</button>
	<div class="row-fluid">
		<div id="titleDiv" class="span10">
			<h2>Title:</h2>
			<input type="text" id="assigntitle" value="{{assignment.title}}"></input>
		</div>
	</div>
	<div class="row-fluid">
		<div class="span5">
			<h3>Assign date:</h3>
			<input type="text" id="assigndate" value="{{start_date}}"></input>
		</div>
		<div class="span5">
			<h3>Due date:</h3>
			<input type="text" id="duedate" value="{{due_date}}"></input>
		</div>
	</div>
	<div class="row-fluid">
		<div id="questionsDiv" class="span10">
			<h2>Questions:</h2>
			<div class="row-fluid">
				<div class="span5" style="padding-left:15px"><h3>Description</div>
				<div class="span1">&nbsp;</div>
				<div class="span1" style="padding-left:25px"><h3>Points</div>
				<div class="span1">&nbsp;</div>
				<input type="hidden" id="questionNum"></input>
			</div>
			<div id="questionsList">
				{% for q in assignment.questions.all %}
				<div class="row-fluid question-whole" id="question{{forloop.counter}}"> 
					<input type="hidden" value = "{{q.data}}"></input> 
					<div class="span5 question-description">{{q.title}}
					</div> 
					<div class="span1 question-edit btn" onclick="load_question({{forloop.counter}})">
						<i class="icon-edit-sign"> Edit</i> 
					</div> 
					{% with id=q.id %}
					<div class="span1 question-pts"> 
						<input type="text" class="input-fit point-value" value="{{assign_data.questions|lookup:id}}"></input> 
					</div>
					{% endwith %}
					<div class="span1 question-remove btn" onclick="remove_question({{forloop.counter}})"> 
						<i class="icon-remove-sign"></i> 
					</div> 
				</div>
				{%endfor%}
			</div>
		</div>
	</div>

	<button class="btn btn-inverse" id="opener">
		<i class="icon-plus"></i> Add Question </button>

	<button class="btn" id="listingQ">
		<i class="icon-plus"></i> Load Existing Question</button>
	<div id="dialog" class="row-fluid">
		<div class="span7" id="editDiv">
			<div class="row-fluid">
				<h2>Title</h2>
				<input type="text" id="questiontitle" name="title"></input>
			</div>
			<div class="row-fluid">
				<h2>Code:</h2>
				<div id="codediv" class="span12"></div>
			</div>
			<div class="row-fluid">
				<h3>Solution:</h3>
				<div id="solndiv" class="span12 answer"></div>
			</div>
			<div class="row-fluid">
				<h3>Other choices:</h3>
				<div class="span12" id="choicediv"></div>
				<button class="btn btn-inverse" onclick="add_choice_div()">
					<i class="icon-plus"></i> Add Choice 
				</button>
			</div>

			<div class="row-fluid">
				<div id="textdiv" class="span12">
					<h2>Text:</h2>
					<textarea name="text" id="text"></textarea>
				</div>
			</div>
		</div>
		<div class="span5 previewDiv" style="position:fixed">
			<h1>Question Preview</h1>
			<div id="dialogPreview" style="border-style:solid"></div>
			<div class="row-fluid">
				<div class="span3">
					<button id="question-save-button" class="btn-primary btn btn-large">Save</button>
				</div>
				<div class="span3">
					<button id="preview-button" onclick="preview_question()" 
						class="btn-primary btn btn-large">Preview</button>
				</div>
			</div>
		</div>
	</div>

	<hr>
	<form action="{% url "preview_assignment" %}" method="post" id="previewform">
	{% csrf_token %}
		<input type="text" style="display:none" id="previewdata" name="previewdata"></input>
		<button  class="btn" onclick="previewA()">Preview</button>
	</form>
	<form action="{% url "create_assignment" %}" method="post" id="assignmentForm">
	{% csrf_token %}
		<input type="text" style="display:none" id="assignmentdata" name="assignmentdata"></input>
		<button type="button" class="btn btn-primary" onclick="save()">submit</button>
	</form>
<div id="loading-zone">
	{% if question_list %}
	<div class="lookyhere">
   	<body>  
		<table class="table">  
      	<thead>  
        		<tr>  
           		<th>Title</th>
           		<th>Subject</th>
           		<th>Author</th>
           		<th>Rating</th>
        		</tr>  
      	</thead> 
      	<tbody>
   	{% for question in question_list %}
   		<tr>
   			<td id="{{question.id}}title" value="{{ question.title }}">{{ question.title }}</td>
				<td></td>
				<td></td>
				<td></td>
				<td><i id="{{question.id}}" class="icon-eye-open" onclick="iframe_preview({{question.id}})"></i></a></td>
				<input type="hidden" id="{{question.id}}data" value="{{question.data}}"></div>
			</tr>
		
	   {% endfor %}
   	   </tbody>  
   	</table>  
	</div>
	{% else %}
   	<p>No questions exist!</p>
	{% endif %}
	<button type="button" class="btn btn-success" onclick="loadExisting()">Load Questions</button>
	<div class="preview-area">
	</div>
</div>

<div id="template-zone">
	<div class="lookyhere"> 
		<table class="table">  
      	<thead>  
        		<tr>  
           		<th>Title</th>
           		<th>Subject</th>
           		<th>Author</th>
           		<th>Rating</th>
        		</tr>  
      	</thead> 
      	<tbody>
   	{% for a in assignment_list %}
   		<tr class="template-row" id="{{a.id}}T">
   			<td class="first-cell" id="{{a.id}}Ttitle" value="{{a.title}}">{{ a.title }}</td>
				<td></td>
				<td></td>
				<td></td>
				<td><i onclick="previewT({{a.id}})" class="icon-eye-open"></i></a></td>
				<input type="hidden" id="{{a.id}}Tdata" value="{{a.data}}"></div>
			</tr>
	   {% endfor %}
   	   </tbody>  
   	</table>  
	</div>
	<div class="row-fluid">
		<button class="btn btn-success load-template">Load</button>
		<button class="btn btn-warning cancel-template-load">Cancel</button>
	</div>
	<div class="template-area">
	</div>
</div>
</body>
{% endblock %}
